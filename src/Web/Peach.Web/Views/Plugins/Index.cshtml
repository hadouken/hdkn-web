@using Peach.Data.Domain
@model IEnumerable<Plugin>

@{
    ViewBag.Title = "Plugins | Hadouken";
}

@if (User.IsInRole(Role.PluginDeveloper))
{
    @section Actions
    {
        @Html.ActionLink("Upload plugin", "New")
    }
}

<div class="row">
    <div class="col-lg-12">
        <div class="bs-callout bs-callout-info">
            <p>The plugins listed here are not necessarily made by the authors of Hadouken. Anyone can
                become a plugin developer and it is super easy to get going.</p>
            
            <p>Although you can download plugins here, this is just a mirror of the official Hadouken plugin
            repository which you can browse from your Hadouken instance.</p>
        </div>

        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th style="width: 20%;">Name</th>
                    <th>Description</th>
                    <th style="width: 15%;">Version</th>
                </tr>
            </thead>
            
            <tbody>
                @foreach (var plugin in Model)
                {
                    var latestRelease = plugin.Releases.OrderByDescending(r => r.ReleaseDate).FirstOrDefault();
                    
                    <tr>
                        <td><a href="@Url.Action("Details", new {pluginId = plugin.Name})">@plugin.Name</a></td>
                        <td>@plugin.Description</td>
                        <td>@(latestRelease != null ? latestRelease.Version.ToString() : "")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
